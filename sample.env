# Rename this file to .env and update the values according to your environment

# Database Configuration
DB_HOST=localhost                    # Database server hostname or IP address
DB_PORT=5432                        # Database server port (default PostgreSQL port)
DB_NAME=your_db_name                # Name of the database to connect to
DB_USER=your_db_user                # Database username for authentication
DB_PASSWORD=your_db_password        # Database password for authentication

# JWT (JSON Web Token) Configuration
JWT_SECRET=your-super-secret-jwt-key # Secret key for signing JWT tokens (keep this secure!)
JWT_REFRESH_SECRET=your-super-secret-refresh-key # Secret key for signing JWT refresh tokens (keep this secure!)
JWT_TOKEN_EXPIRATION=1h             # JWT token expiration time (1h = 1 hour)
PASSWORD_SALT_ROUNDS=10             # Number of salt rounds for bcrypt password hashing (higher = more secure but slower)
TOKEN_LIFETIME_HOURS=24             # Token lifetime in hours for session management
MAX_ALLOWED_LOGINS=5                # Maximum number of concurrent login sessions per user

# Rate Limiting Configuration (Login Protection)
RATE_LIMIT_MAX_ATTEMPTS=5           # Maximum login attempts before rate limiting kicks in
RATE_LIMIT_BLOCK_DURATIONS=15,30,60 # Progressive block durations in minutes (1st block: 15min, 2nd: 30min, 3rd: 60min)
RATE_LIMIT_BLOCK_DURATION=15        # Initial block duration in minutes for first offense
RATE_LIMIT_WINDOW_DURATION=60       # Time window in minutes to track login attempts
RATE_LIMIT_ATTEMPT_RESET=15         # Time in minutes after which failed attempts counter resets
RATE_LIMIT_MAX_BLOCK_COUNT=2        # Maximum number of progressive blocks before permanent action
RATE_LIMIT_ENABLE_CLEANUP=true      # Enable automatic cleanup of old rate limit records
RATE_LIMIT_CLEANUP_INTERVAL=60      # Interval in minutes for cleaning up expired rate limit records

# Password Reset Rate Limiting Configuration
PWD_RESET_MAX_ATTEMPTS=3           # Maximum password reset attempts before blocking
PWD_RESET_BLOCK_DURATION=15         # Block duration in minutes for password reset attempts
PWD_RESET_MAX_FAILURE_ATTEMPTS=5    # Maximum failed password reset attempts before extended block
PWD_RESET_FAILURE_BLOCK_DURATION=30 # Extended block duration in minutes for repeated failures
PWD_RESET_MAX_ACTIVE_TOKENS=2       # Maximum number of active password reset tokens per user
PWD_RESET_TOKEN_EXPIRATION=15       # Password reset token expiration time in minutes

# Application Configuration
APP_NAME=Node Auth                 # Application name used in emails and UI
NODE_ENV=development               # Environment: development, production, test
PORT=3000                          # Server port

# CORS Configuration
CORS_ORIGIN=*                      # Allowed origins for CORS (use specific URLs in production)

# Email Configuration
FROM_EMAIL=noreply@nodeauth.com    # Email address for outgoing emails
FROM_NAME=Node Auth Team           # Display name for outgoing emails
SENDGRID_API_KEY=your_sendgrid_api_key_here  # SendGrid API key for email delivery